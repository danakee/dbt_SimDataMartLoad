{{ config(
    materialized='incremental',
    incremental_strategy='merge',
    unique_key=['ProjectPKey'],
    sqlserver_identity_insert=False,
    on_schema_change='ignore',
    database='SimulationsAnalytics',
    alias='DimProject',
    tags=['mart'],
    merge_update_columns=[
        'ProjectName',
        'ProjectDescription',
        'ProjectStatusCode',
        'ProjectStatusDescription',
        'ProjectTypeCode',
        'ProjectTypeDescription',
        'ReportTypeDescription',
        'IsEAC',
        'IsStopDR',
        'ProjectManagerFirstName',
        'ProjectManagerLastName',
        'EffectiveDate',
        'IsLatest',
        'HvrChangeTime'
    ],
    merge_insert_columns=[
        'ProjectPKey',
        'ProjectName',
        'ProjectDescription',
        'ProjectStatusCode',
        'ProjectStatusDescription',
        'ProjectTypeCode',
        'ProjectTypeDescription',
        'ReportTypeDescription',
        'IsEAC',
        'IsStopDR',
        'ProjectManagerFirstName',
        'ProjectManagerLastName',
        'EffectiveDate',
        'IsLatest',
        'HvrChangeTime'
    ]
)}}

WITH ProjectData AS (
    SELECT
        ProjectPKey,
        ProjectName,
        ProjectDescription,
        ProjectStatusCode,
        ProjectStatusDescription,
        ProjectTypeCode,
        ProjectTypeDescription,
        ReportTypeDescription,
        IsEAC,
        IsStopDR,
        ProjectManagerFirstName,
        ProjectManagerLastName,
        EffectiveDate,
        IsLatest,
        HvrChangeTime
    FROM {{ ref('stg_project') }}
)

SELECT
    *
FROM
    ProjectData
